# Bootstrap 配置文件
# 作者: mumu
# 描述: 用于配置 Nacos 配置中心连接信息，在应用启动时优先加载
#       此文件只包含启动所需的最基础配置，其他配置从 Nacos 配置中心获取
#
# 微服务支持说明：
#   本配置支持单体应用和微服务架构无缝切换
#   - Spring Cloud 仅用于配置管理，不强制微服务架构
#   - 配置文件按环境(woodlin-{env}.yml)和应用(woodlin-{app}.yml)分离
#   - 切换到微服务时，每个服务有独立的应用配置文件

spring:
  application:
    name: ${SPRING_APPLICATION_NAME:woodlin-admin}
  
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}
  
  # Nacos 配置中心
  cloud:
    nacos:
      # Nacos 服务器地址
      server-addr: ${NACOS_SERVER_ADDR:localhost:8848}
      # Nacos 用户名（如果开启了鉴权）
      username: ${NACOS_USERNAME:nacos}
      # Nacos 密码（如果开启了鉴权）
      password: ${NACOS_PASSWORD:nacos}
      # Nacos 命名空间（用于环境隔离，默认为public）
      namespace: ${NACOS_NAMESPACE:}
      # Nacos 分组（默认为DEFAULT_GROUP）
      group: ${NACOS_GROUP:DEFAULT_GROUP}
      
      # Nacos 配置中心配置
      config:
        # 是否启用 Nacos 配置中心
        enabled: ${NACOS_CONFIG_ENABLED:true}
        # 配置文件格式
        file-extension: yml
        # 共享配置（按优先级加载，后面的会覆盖前面的）
        shared-configs:
          # 环境配置：根据环境变量加载，如 woodlin-dev.yml, woodlin-test.yml, woodlin-prod.yml
          # 包含数据库、Redis、MyBatis 等基础设施配置
          - data-id: woodlin-${spring.profiles.active}.yml
            group: ${NACOS_GROUP:DEFAULT_GROUP}
            refresh: true
          # 应用配置：woodlin-admin 应用特定配置
          # 包含认证、文档、业务功能等应用特定配置
          - data-id: woodlin-${spring.application.name}.yml
            group: ${NACOS_GROUP:DEFAULT_GROUP}
            refresh: true
        # 配置刷新超时时间（毫秒）
        refresh-timeout: 3000
        # 配置获取超时时间（毫秒）
        timeout: 3000
        # 配置变更监听长轮询超时时间（毫秒）
        config-long-poll-timeout: 30000
        # 配置重试时间（毫秒）
        config-retry-time: 2000
        # 最大重试次数
        max-retry: 3
        # 启动时是否加载配置
        enable-remote-sync-config: true
